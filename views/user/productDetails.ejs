<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VisionVogue - ProductDetails</title>
    <link rel="stylesheet" href="/css/productDetails.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    
    <header>
        <nav class="navbar">
            <ul class="nav-links">
                <li><a href="/home">Home</a></li>
                <li><a href="/shop">shop</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Contact us</a></li>
            </ul>
            <div class="logo">VisionVogue</div>
            <div class="nav-icons">
               <a href="/wishlist" ><i class="fa-regular fa-heart"></i></a>
               <a href="/cart"> <i class="fa-solid fa-cart-shopping"></i></a>
              <a href="/profile" > <i class="fa-regular fa-user"></i></a>
            </div>
        </nav>
    </header>
     <main class="product-page-wrapper">
    <div class="product-container">
        <div class="gallery-section">
            <div class="main-display-area">
                <div class="image-zoom-container" id="zoomContainer">
                    <img id="mainProductImage" src="/uploads/<%=product.productimage[0]%>" alt="<%= product.ProductName %>">
                </div>
            </div>
            
            <div class="thumbnail-grid">
                <% product.productimage.forEach((img, index) => { %>
                    <div class="thumb-card <%= index === 0 ? 'active-thumb' : '' %>" onclick="changeImage('/uploads/<%= img %>', this)">
                        <img src="/uploads/<%= img %>" alt="Thumbnail">
                    </div>
                <% }) %>
            </div>
        </div>

        <div class="info-section-glass">
            <div class="header-info">
                <span class="brand-badge"><%=product.brand%></span>
                <h1 class="product-main-title"><%=product.productName%></h1>
                <p class="category-path"><%=product.category.name%> / Eye Wear</p>
            </div>

            <div class="price-card">
                <div class="price-row">
                    <span class="current-price">₹<%=product.salesPrice%></span>
                    <span class="old-price">₹<%=product.regularPrice%></span>
                    <span class="discount-tag">
                        <%= Math.round((product.regularPrice - product.salesPrice) / product.regularPrice * 100) %>% OFF
                    </span>
                </div>
                <p class="tax-info">Inclusive of all taxes</p>
            </div>

            <div class="description-box">
                <h3>Product Description</h3>
                <p><%= product.description %></p>
            </div>

            <div class="action-area">
                <div class="quantity-selector">
                    <label>Quantity</label>
                    <div class="q-controls">
                        <button onclick="updateQty(-1)">-</button>
                        <input type="number" id="quantity" value="1" readonly>
                        <button onclick="updateQty(1)">+</button>
                    </div>
                </div>

                <div class="btn-group">
                    <% if (product.quantity > 0) { %>
                        <button class="add-cart-premium" onclick="addToCart('<%=product._id%>')">
                            <i class="fa-solid fa-bag-shopping"></i> ADD TO CART
                        </button>
                    <% } else { %>
                        <button class="out-of-stock-btn" disabled>OUT OF STOCK</button>
                    <% } %>
                </div>
            </div>

            <div class="trust-badges">
                <div class="badge"><i class="fa-solid fa-truck-fast"></i> <span>Fast Delivery</span></div>
                <div class="badge"><i class="fa-solid fa-rotate-left"></i> <span>30 Days Return</span></div>
                <div class="badge"><i class="fa-solid fa-shield-halved"></i> <span>Secure Payment</span></div>
            </div>
        </div>
    </div>
</main>
     <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h4>About Us:</h4>
                <a href="#">Our Story</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Terms</a>
                <a href="#">FAQ</a>
            </div>
            <div class="footer-column">
                <h4>Support:</h4>
                <a href="#">Shipping Policy</a>
                <a href="#">Returns</a>
                <a href="#">Order Tracking</a>
                <a href="#">Help</a>
            </div>
            <div class="footer-column">
                <h4>My Account:</h4>
                <a href="#">Profile</a>
                <a href="#">My Orders</a>
                <a href="#">Wishlist</a>
                <a href="#">Refer & Earn</a>
            </div>
            <div class="footer-column">
                <h4>Contact:</h4>
                <p>Email: visionvogue@gmail.com</p>
                <p>Phone: 8923457190</p>
            </div>
        </div>
        <p class="copyright">© 2026 Eyewear Store. All rights reserved.</p>
    </footer>
    
   <script>
    // 1. തംബ്നെയിൽ ക്ലിക്ക് ചെയ്യുമ്പോൾ മെയിൻ ഇമേജ് മാറ്റാൻ
function changeImage(imagePath, element) {
    const mainImg = document.getElementById('mainProductImage');
    mainImg.src = imagePath;

    // ആക്റ്റീവ് ബോർഡർ മാറ്റാൻ
    document.querySelectorAll('.thumb-card').forEach(card => card.classList.remove('active-thumb'));
    element.classList.add('active-thumb');
}

// 2. സൂമിംഗ് ഫങ്ക്ഷൻ (പുതിയ ക്ലാസ്സ് നേയിമുകൾ അനുസരിച്ച്)
const container = document.getElementById('zoomContainer');
const img = document.getElementById('mainProductImage');

container.addEventListener('mousemove', (e) => {
    const rect = container.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;

    img.style.transformOrigin = `${x}px ${y}px`;
    img.style.transform = "scale(2.5)";
});

container.addEventListener('mouseleave', () => {
    img.style.transformOrigin = "center";
    img.style.transform = "scale(1)";
});

// 3. ക്വാണ്ടിറ്റി കൂട്ടാനും കുറയ്ക്കാനും (Update Qty)
function updateQty(val) {
    const qtyInput = document.getElementById('quantity');
    let currentQty = parseInt(qtyInput.value);
    let maxQty = 3; // നിങ്ങൾ സെറ്റ് ചെയ്ത ലിമിറ്റ്

    let newQty = currentQty + val;

    if (newQty >= 1 && newQty <= maxQty) {
        qtyInput.value = newQty;
    } else if (newQty > maxQty) {
        Swal.fire({
            icon: 'warning',
            title: 'Limit Exceeded',
            text: 'You can only add a maximum of 3 units.',
            timer: 1500,
            showConfirmButton: false
        });
    }
}

// 4. Add to Cart (Ajax)
function addToCart(productId) {
    const quantity = parseInt(document.getElementById('quantity').value);

    $.ajax({
        url: '/cart',
        method: 'POST',
        data: { 
            productId: productId,
            quantity: quantity 
        },
        success: (response) => {
            if (response.status) {
                Swal.fire({
                    icon: 'success',
                    title: 'Added to cart',
                    text: 'The product has been added to your Cart',
                    timer: 2000
                });
            } else {
                Swal.fire({
                    icon: 'info',
                    title: 'Already in Cart',
                    text: response.message
                });
            }
        },
        error: (error) => {
            Swal.fire({
                icon: 'error',
                title: 'Error',
                text: 'Something went wrong!'
            });
        }
    });
}
</script>
</body>
</html>